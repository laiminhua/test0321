(()=>{var Yt=Object.create;var H=Object.defineProperty;var Zt=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var ee=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var ie=(s,t,e)=>t in s?H(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var dt=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports);var ne=(s,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of te(t))!se.call(s,n)&&n!==e&&H(s,n,{get:()=>t[n],enumerable:!(i=Zt(t,n))||i.enumerable});return s};var z=(s,t,e)=>(e=s!=null?Yt(ee(s)):{},ne(t||!s||!s.__esModule?H(e,"default",{value:s,enumerable:!0}):e,s));var gt=(s,t,e)=>(ie(s,typeof t!="symbol"?t+"":t,e),e);var St=dt((Ie,oe)=>{oe.exports={name:"spray-conch-compile",version:"3.0.0",description:"",private:!0,egg:{declarations:!0},port:5e3,dependencies:{"@babel/core":"^7.12.3","@babel/generator":"^7.18.2","@babel/parser":"^7.18.5","@babel/preset-env":"^7.12.1","@babel/traverse":"^7.18.2","@babel/types":"^7.18.4","@rollup/plugin-node-resolve":"^13.3.0","@rollup/plugin-strip":"^2.1.0","@vue/babel-helper-vue-jsx-merge-props":"^1.2.1","@vue/babel-preset-jsx":"^1.2.3","@vue/compiler-sfc":"^2.6.14",babylon:"^6.18.0","cross-env":"^7.0.2",egg:"^2.15.1","egg-axios":"^1.1.5","egg-cors":"^2.2.3","egg-logrotator":"^3.1.0","egg-scripts":"^2.11.0",esbuild:"^0.14.43",jscodeshift:"^0.13.1","patch-package":"^6.5.0",rimraf:"^3.0.2",rollup:"^2.32.1","rollup-plugin-babel":"^4.4.0","rollup-plugin-terser":"^7.0.2",sass:"^1.27.0",shelljs:"^0.8.4","string-to-file-stream":"^1.2.0"},devDependencies:{"@release-it/conventional-changelog":"^3.3.0",autod:"^3.0.1","autod-egg":"^1.1.0",compressing:"^1.5.1","egg-bin":"^4.11.0","egg-ci":"^1.11.0","egg-mock":"^3.21.0",eslint:"^5.13.0","eslint-config-egg":"^7.1.0","release-it":"^14.11.8",rimraf:"^3.0.2"},engines:{node:">=10.0.0"},scripts:{start:"cross-env EGG_SERVER_ENV=prod MOCK_HOME_DIR=./logs/scripts egg-scripts start ","start-test":"cross-env EGG_SERVER_ENV=test MOCK_HOME_DIR=./logs/scripts egg-scripts start ",stop:"egg-scripts stop ",dev:"egg-bin dev EGG_SERVER_ENV=local",debug:"egg-bin debug",test:"npm run lint -- --fix && npm run test-local","test-local":"egg-bin test",cov:"egg-bin cov",lint:"eslint .",ci:"npm run lint && npm run cov",autod:"autod",build:"node ./script/build.js",restart:"npm run stop && npm run start","restart-test":"npm run stop && npm run start-test",release:"release-it --no-npm.publish",postinstall:"patch-package"},ci:{version:"10"},repository:{type:"git",url:"git@git.uino.com:hundun/nanshan-compile-preview.git"},author:"zhanglin@uinnova.com",license:"MIT",babel:{presets:["@vue/babel-preset-jsx"]}}});var j=dt((Ve,xt)=>{var re=St(),Et=[["rgb(255, 255, 204)","rgb(222, 252, 205)","rgb(189, 249, 206)","rgb(157, 246, 207)","rgb(124, 242, 208)","rgb(91, 239, 209)"],["rgb(52, 255, 245)","rgb(49, 224, 242)","rgb(45, 192, 238)","rgb(42, 161, 235)","rgb(39, 130, 231)","rgb(35, 98, 228)"],["rgb(255, 220, 132)","rgb(255, 196, 124)","rgb(254, 171, 117)","rgb(254, 147, 109)","rgb(254, 123, 101)","rgb(253, 98, 94)"],["rgb(109, 212, 0)","rgb(91, 218, 39)","rgb(73, 224, 78)","rgb(55, 230, 117)","rgb(36, 235, 156)","rgb(18, 241, 195)"],["rgb(215, 74, 255)","rgb(198, 78, 255)","rgb(181, 82, 255)","rgb(164, 86, 255)","rgb(146, 90, 255)","rgb(129, 94, 255)"],["rgb(68, 215, 182)","rgb(99, 198, 159)","rgb(130, 182, 137)","rgb(162, 165, 114)","rgb(193, 148, 91)","rgb(224, 132, 69)"],["rgb(255, 87, 56)","rgb(239, 141, 122)","rgb(223, 196, 189)","rgb(207, 250, 255)","rgb(138, 214, 255)","rgb(69, 178, 255)"],["rgb(120, 69, 255)","rgb(165, 121, 251)","rgb(210, 173, 247)","rgb(255, 225, 243)","rgb(255, 170, 197)","rgb(255, 116, 151)"],["rgb(255, 104, 61)","rgb(255, 144, 122)","rgb(255, 185, 182)","rgb(255, 225, 243)","rgb(170, 209, 219)","rgb(85, 192, 196)"],["rgb(91, 11, 255)","rgb(146, 82, 251)","rgb(200, 154, 247)","rgb(255, 225, 243)","rgb(255, 170, 237)","rgb(255, 116, 231)"],["rgb(255, 112, 76)","rgb(255, 150, 132)","rgb(255, 187, 187)","rgb(255, 225, 243)","rgb(255, 204, 162)","rgb(255, 182, 81)"],["rgb(77, 177, 86)","rgb(136, 193, 138)","rgb(196, 209, 191)","rgb(255, 225, 243)","rgb(190, 197, 247)","rgb(126, 170, 251)"]];xt.exports={version:re.version,globalVar:{themeColor:Et,scripts:{},async:!1,printLog:!0,resource:{fontOptimize:!1}},themeColor:Et}});function B(s){let t=parseInt(s.style.display==="none"?0:getComputedStyle(s).height);return Number.isNaN(t)?0:t}function mt(s,t){t.forEach(e=>{q(s.prototype,e.prototype)})}function q(s,t,e=!0){Object.getOwnPropertyNames(t).forEach(i=>{(!s[i]||s[i]&&e)&&(s[i]=t[i])})}function A(s={}){if(s){if(!Array.isArray(s)){let{top:t=0,right:e=0,bottom:i=0,left:n=0}=s;s=[t,e,i,n]}return s.map(t=>p(t)).join(" ")}return 0}function I(s,t=""){if(!s)return;let e=t.split("."),i;for(;i=e.shift();)if(s[i])s=s[i];else return null;return s}function S(s){if(!s||typeof s!="object")return s;let t=s instanceof Array?[]:{};for(let e in s)t[e]=typeof s[e]=="object"?S(s[e]):s[e];return t}function C(s,t){return typeof s!=typeof t&&console.warn("\u7EC4\u4EF6\u6570\u636E\u7C7B\u578B\u53D1\u751F\u66F4\u6539\u53EF\u80FD\u5B58\u5728\u9519\u8BEF"),s&&t&&!Array.isArray(s)&&!Array.isArray(t)&&typeof s=="object"&&typeof t=="object"?Object.assign(t,s):s}function U(s,t){!s||Object.entries(s).forEach(t)}var _t=s=>typeof s=="boolean",p=s=>`${s||0}px`,yt=s=>s.substring(0,1).toUpperCase()+s.substring(1),m=s=>typeof s=="function",$=s=>s==null;function bt(s,t){if(s==="1.0.0"||s==="2")return!0;let e=s.split("."),i=t.split("."),n=e.length,o=i.length,r=Math.min(n,o),a=0;for(a;a<r;a++){let c=parseInt(e[a]),h=parseInt(i[a]);if(c>h)return 1;if(c<h)return-1}if(n>o){for(let c=a;c<n;c++)if(parseInt(e[c])!=0)return 1;return 0}else if(n<o){for(let c=a;c<o;c++)if(parseInt(i[c])!=0)return-1;return 0}return 0}function V(s){return new s({errorCaptured:t=>{let e=this,{id:i}=this;return g({id:i,instance:e,error:t}),!1}})}function g({id:s="",instance:t={},error:e}){conch.__globalVar.printLog&&console.error(s+`\u56FE\u8868\u6267\u884C\u9519\u8BEF:
`+e),conch.errorHandler&&conch.errorHandler({id:s,...t},e)}var wt=()=>({name:"\u84DD\u56FE\u8282\u70B9",group:"UI-Chart",inputs:[{name:"\u663E\u793A",type:"exec"},{name:"\u9690\u85CF",type:"exec"},{name:"\u6570\u636E",type:"any"}],outputs:[]}),G=class{static init(){let{options:t}=this.__richConfig;if(!t)t={};else if(typeof t=="string")try{t=new Function("return "+t)()}catch{throw t={},new Error("\u8F6C\u6362\u56FE\u8868json\u51FA\u73B0\u9519\u8BEF")}else t=S(t);if(Array.isArray(t)?t={blueprint:wt(),propertyPanel:t}:(!t.blueprint||Object.keys(t.blueprint).length<2)&&(t.blueprint=wt()),Array.isArray(t.propertyPanel)&&t.propertyPanel.length>0){let e={};(function(i){i.forEach(n=>{let o=e;if(n.key){let r=n.key.split(".");r.shift();for(let a=0;a<r.length;a++)a<r.length-1?(o[r[a]]||(o[r[a]]={name:r[a],type:"group",children:{}}),o=o[r[a]].children):(n.default=n.value,delete n.value,delete n.key,o[r[a]]=n)}else func(n.children)})})(t.propertyPanel),t.propertyPanel=e}this._options=t}getBlueprintNode(t,e){let i=this;return class extends BaseNode{static config={...i._options.blueprint,name:t||i._options.blueprint.name,id:e};constructor(){super()}isEntrance(){return!0}onExecute(o,r,a){i.onExecute(o,r,a,this)}onStop(){i.onStop(this)}}}onExecute(t,e,i,n){switch(n.curExecName){case"\u663E\u793A":this.show();break;case"\u9690\u85CF":this.hide();break}e._updateData_&&this.setData(e._updateData_)}onStop(){}},Ct=G;function Ot(s){return[s.text,{...s.font,textAlign:s.site,fontSize:p(s.font.fontSize),lineHeight:s.lineHeight?p(s.lineHeight):null,padding:A(s.padding)}]}function vt(s,t,e){s.innerHTML=t,e&&Object.assign(s.style,e)}var K=class{static init(){this.titleDom=document.createElement("div"),this.subTitleDom=document.createElement("div"),this.parentDom.appendChild(this.titleDom),Object.assign(this.titleDom.style,{flexShrink:0}),Object.assign(this.subTitleDom.style,{flexShrink:0}),this.parentDom.appendChild(this.subTitleDom)}__resizeParentHeight(){this.dom.style.height=`calc(100% - ${p(B(this.titleDom)+B(this.subTitleDom))})`}setTitle(t,e){vt(this.titleDom,t,e)}setSubTitle(t,e){vt(this.subTitleDom,t,e)}openTitle(){this.titleDom.style.display="block",this.resize()}closeTitle(){this.titleDom.style.display="none",this.resize()}openSubTitle(){this.subTitleDom.style.display="block",this.resize()}closeSubTitle(){this.subTitleDom.style.display="none",this.resize()}updateTitle(t){t&&(this.titleDom.style.display=t.show?"block":"none",this.setTitle(...Ot(t)))}updateSubTitle(t){t&&(this.subTitleDom.style.display=t.show?"block":"none",this.setSubTitle(...Ot(t)))}},Dt=K;var $t=z(j());var W=class{static init(){this.themes=$t.themeColor,this.themeIndex=1}__setPadding(t){this.padding!==t&&(this.padding=t),Object.assign(this.parentDom.style,{padding:A(t)})}setPadding(t){this.__setPadding(t),this.resize()}setCompBG(t=""){Object.assign(this.parentDom.style,{background:t,backgroundRepeat:"no-repeat",backgroundSize:"100% 100%"})}setTheme(t){this.theme!==t&&(this.theme=t),this.render()}__updateTheme(t=this.theme){if(!!t)if(t.backgroundColor&&t.backgroundColor.show){let e=t.backgroundColor,{type:i,value:n}=e,o="";if(i==="image")e.url&&(o=`url(${e.url})`);else if(n)switch(i){case"flat":o=n;break;case"linearGradient":let{angle:r,stops:a}=n;o=`linear-gradient(${r}deg, ${a.map(c=>`${c.color} ${c.offset}%`).join(",")})`;break;case"radialGradient":o=`radial-gradient(${n.stops.map(c=>`${c.color} ${c.offset}%`).join(",")})`;break}this.setCompBG(o)}else this.setCompBG("")}__transform(){this.padding&&this.__setPadding(this.padding);let t=I(this.config||this.opts,"menu.title");if(t){let{title:e,subTitle:i}=t;this.updateTitle(e),this.updateSubTitle(i)}}},jt=W;var J=class{constructor(t){this.identified=t,this.operations=[]}done(...t){this.operations=this.operations.concat(t.filter(e=>typeof e=="function"))}async _run(...t){for(let e=0,i;i=this.operations[e];e++)await i(...t)}remove(t){let e=this.operations.length;for(let i=e-1;i>=0;i--)t===this.operations[i]&&this.operations.splice(i,1)}destroy(){this.identified=null,this.operations=null}},Pt=J;var X=class{constructor(t){this.actions={},this.instance=t}wait(t){return this.actions[t]?this.actions[t]:this.actions[t]=new Pt(t)}clearWait(t,e){if(!t&&!e){Object.values(this.actions).forEach(i=>i.destroy()),this.actions={};return}if(!!this.actions[t]){if(!e){this.actions[t].destroy(),delete this.actions[t];return}this.actions[t].remove(e)}}trigger(t,...e){this.actions[t]&&this.actions[t]._run(...e)}},Tt=X;var Q=class{static init(){this._waiter=new Tt(this)}trigger(...t){return this._waiter.trigger(...t)}on(t,e){this._waitAction(t).done(e)}off(t,e){this._clearWaitAction(t,e)}_waitAction(t){return this._waiter.wait(t)}_clearWaitAction(t,e){this._waiter.clearWait(t,e)}},kt=Q;var Y=class{static init(){this._eventTypes={},this._eventBus={}}$on(t,e,i=this){return this.hasType(t)||(this._eventTypes[t]=t,this._eventBus[t]=[]),this._eventBus[t].push([e,i]),this}$once(t,e,i){let n=(...o)=>{this.$off(t,n),e.apply(i,o)};return n.fn=e,this.$on(t,n),this}$off(t,e,i){if(!t&&!e)return this.$offAll(),this;if(!this.hasType(t))return this;if(!e)return this._eventBus[t]=[],this;let n=this._eventBus[t],o=n.length;for(;o>-1;){if(!n[o]){o--;continue}let[r,a]=n[o];(r===e||r.fn===e)&&(i?a===i&&n.splice(o,1):n.splice(o,1)),o--}return this}$emit(t,...e){if(!this.hasType(t))return this;let i=this._eventBus[t];if(i&&i.length){let n=[...i];for(let o of n){let[r,a]=o;r.apply(a,e)}}return this}$offAll(){this._eventTypes={},this._eventBus={}}hasType(t){return this._eventTypes[t]===t}},P=Y;var Z=z(j());var zt=async(s,t)=>{if(Array.from(window.document.fonts.values()).filter(n=>n.family===s)[0])return;let i=new window.FontFace(s,t);await i.load(),window.document.fonts.add(i)};function At(s,t,e){zt(s,`url('${e}/fonts/${t}')`).catch(i=>{console.error("\u5B57\u4F53\u52A0\u8F7D\u5931\u8D25",s,i)})}function ae(s,t,e){let i=t.replace(/\.(ttf|otf)/i,".woff2");zt(s,`url('${e}/fonts/${i}')`).catch(()=>{At(s,t,e)})}var _={script([s,t],e){return new Promise(i=>{let n=window.document.head.querySelector("#"+s);n?n.isLoading?i():n.addEventListener("load",()=>{i()}):(n=document.createElement("script"),n.src=(e||"")+t,n.type="text/javascript",n.isLoading=!1,n.addEventListener("load",()=>{n.isLoading=!0,i()}),n.addEventListener("error",()=>{i()}),n.id=s,window.document.head.appendChild(n))})},css([s,t],e){let i=window.document.head.querySelector("#"+s+"css");i||(i=document.createElement("link"),i.href=(e||"")+t,i.rel="stylesheet",i.id=s+"css",window.document.head.appendChild(i))},font(s,t,e=!1){return new Promise(async i=>{let n=Array.from(window.document.fonts.values());for(let o=0;o<s.length;o++){let{file:r,psName:a,descriptors:c,files:h}=s[o];if(n.some(l=>l.family===a))return;if(h&&c){let l=h.map(f=>new window.FontFace(a,`url('${t}/cssfonts/${f}')`,c).load()),d=await Promise.any(l);window.document.fonts.add(d)}else e?ae(a,r,t):At(a,r,t)}i()})},style(s,t=""){let e=document.head.querySelector("#styles_comp_global_"+t);e||(e=document.createElement("style"),e.type="text/css",e.id="styles_comp_global_"+t,e.appendChild(document.createTextNode(s)),document.head.appendChild(e)),t||e.appendChild(document.createTextNode(s))}};var tt=class{async __initScript(){let{script:t}=this.__richConfig,e=this._config.prefix||"";if(!Z.globalVar.async&&t){this.script=t,this._config&&this._config.script&&Object.entries(this._config.script).forEach(([o,r])=>{this.script[o]=r});let i=Object.entries(this.script).filter(([o,r])=>typeof r=="string"),n=i.shift();for(;n;)await _.script(n,e),n=i.shift()}}__initResource(){let{img:t,fonts:e,cssfonts:i,css:n,script:o}=this.__richConfig,r=this._config.prefix||"";e&&_.font(Object.values(e),r,Z.globalVar.resource.fontOptimize),i&&_.font(i,r),this.img={},this.fonts={},U(t,([a,c])=>{this.img[a]=(r||"")+c}),U(e,([a,c])=>{this.fonts[a]=c.file}),n&&Object.entries(this.css=n).filter(([a,c])=>typeof c=="string").forEach(a=>{_.css(a,r)}),this.script=o}},It=tt;var ce=["create","mounted","update","dataChange","optsChange","destory"],F=class{static init(){this.__LifeCycle={},m(this.setup)&&(this.__getDom=this.setup())}__callHook(t,e){return this.__LifeCycle[t]?this.__LifeCycle[t].reduce((i,n)=>n(i),e):e}};ce.forEach(s=>{s=yt(s),[`onBefore${s}`,`onAfter${s}`].forEach(t=>{F.prototype[t]=function(e){m(e)&&(this.__LifeCycle[t]||(this.__LifeCycle[t]=[]),this.__LifeCycle[t].push(e))}})});var Vt=F;var et=class{changeOptsToConfig(t=!0){if(this.type==="complex"){this._componentInstances.forEach((i,n)=>{i.changeOptsToConfig(t),this.updateConfig(i,n)});return}if(!this.opts||!this._options.propertyPanel||Object.prototype.toString.call(this._options.propertyPanel).slice(8,-1)!=="Array")return;let e=i=>{if(i.type==="group")for(let n of i.children)e(n);else{if(!(typeof i.key=="string"&&i.key!==""))return;let n=i.key.split(".");n.length>=1&&n.shift();let o=this.opts,r=o,a="";for(a of n)if(r=o,o=o[a],o===void 0||isNaN(o)){o=void 0;break}(o!==void 0||!isNaN(o))&&(t?i.value=o:r[a]=i.value)}};for(let i of this._options.propertyPanel)e(i);t||this.setOption(this.opts)}changeConfigToOpts(){this.changeOptsToConfig(!1)}changeOptsToPropertyPanel(t){if(this.type==="complex"){this._componentInstances.forEach((r,a)=>{r.changeOptsToPropertyPanel(this.opts[a]),this.updateConfig(r,a)});return}let e=this._options.propertyPanel||{},i=t||(this.type==="echarts"?this.config:this.opts);if(Object.prototype.toString.call(i).slice(8,-1)!=="Object"){console.warn("opts\u9700\u8981\u662F\u5BF9\u8C61\u7C7B\u578B\u7684\u6570\u636E");return}Object.keys(i).forEach(r=>{o(r,e,i)});function o(r,a,c){let h=a,l=c;Object.prototype.toString.call(l[r]).slice(8,-1)==="Object"?(l=l[r],h[r]&&h[r].children?h=h[r].children:h[r]&&h[r].default&&!h[r].children&&(h[r].default=l),Object.keys(l).forEach(f=>{o(f,h,l)})):h[r]&&h[r].default!==void 0&&(h[r].default=l[r])}}changePropertyPanelToOpts(){if(this.type==="complex")return this._componentInstances.map((r,a)=>{let c=r.changePropertyPanelToOpts();return this.updateConfig(r,a),c});let t=this._options.propertyPanel||{},e=this.type==="echarts"?this.config:this.opts;Object.keys(t).forEach(o=>{n(o,t,e)});function n(o,r,a){let c=r,h=a;!c[o].default&&c[o].children&&h[o]?(h=h[o],c=c[o].children,Object.keys(c).forEach(d=>{n(d,c,h)})):h.hasOwnProperty(o)&&(h[o]=c[o].default)}return this.setOption(e),e}changeProperty(t,e,i,n){this.setOption(i)}},Ft=et;var Nt=z(j());var he={info:"background:#606060;color:#fff;",warn:"background:#E9A400;color:#fff;",error:"background:#EC3941;color:#fff;"};function le(s){return[he[s],"background:#1375B2;color:#fff;"]}function pe(){let s=new Date;return`${s.toLocaleDateString()} ${s.toLocaleTimeString()}`}var st=class{info(...t){this._recordLog("info",...t)}warn(...t){this._recordLog("warn",...t)}error(...t){this._recordLog("error",...t)}_recordLog(t,...e){window.console[t](`%c [conch ${t}] %c ${pe()} `,...le(t),...e)}memory(){let{memory:t}=performance;if(t){let e=r=>`${r/1024/1024}M`,{jsHeapSizeLimit:i,totalJSHeapSize:n,usedJSHeapSize:o}=t;console.table({max:e(i),has:e(n),used:e(o)})}}},Mt=new st;var Lt=new P;P.init.call(Lt);var O=Lt;var Rt=new WeakMap,E=class{static __richComp(t){let e=t.prototype,i=e.destroy;e.destroy=function(){this.__callHook("onBeforeDestory"),(m(i)?function(){this.__destroy(),i.call(this)}:this.__destroy).call(this),this.__callHook("onAfterDestory"),this._clearWaitAction(),this.$offAll()},e.render=e.__initRender;let n=e.setData;e.setData=function(r,...a){let c=this.__callHook("onBeforeDataChange",r);$(c)&&(r=c),n&&n.call(this,r,...a),this.__callHook("onAfterDataChange")};let o=e.setOption;e.setOption=function(r,...a){let c=this.__callHook("onBeforeOptsChange",r);$(c)&&(r=c),o&&o.call(this,r,...a),this.__callHook("onAfterOptsChange")}}static __use(t){mt(E,E.used=t)}constructor(t,e={}){for(this.cb=[],e.prefix||(e.prefix="");!e.fromComplex&&t.hasChildNodes();)t.removeChild(t.firstChild);if(e.fromComplex&&e.select){let c=e.select[e._id];c&&(t.style.border=c)}this.log=Mt,this._config=e,this.root=O;let i=this._config.prefix;this._registerImg&&this._registerImg(i),this.parentDom=t,Object.assign(t.style,{transformOrigin:"0 0",display:"flex",flexDirection:"column"});let n=document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.boxSizing="border-box";let{key:o,width:r,height:a}=this.__richConfig;this.size={width:r,height:a},this._key=o,this.__setClassName(),Array.isArray(E.used)&&E.used.forEach(c=>c.init&&c.init.call(this)),this.__initResource(),t.appendChild(this.dom=n)}get instance(){return Rt.get(this)}set instance(t){t&&Rt.set(this,t)}show(){if(this.parent)return this.parent.show();this.parentDom.style.display="block"}hide(){if(this.parent)return this.parent.hidden();this.parentDom.style.display="none"}hidden(){return this.hide()}toJSON(){return{data:this.data,opts:this.type==="echarts"?this.config:this.opts,theme:this.theme,padding:this.padding,events:this.events}}__setClassName(){this.parentDom.classList.contains(this._key)||this.parentDom.classList.add(this._key)}async __initComp(){await Promise.resolve(),this.__callHook("onBeforeCreate"),Nt.globalVar.async?this.__initScript():await this.__initScript(),this.__initConfig(),this.__callHook("onAfterCreate"),this.created&&this.created(),this._isLoadingComp=!0,this.cb.forEach(t=>t()),this.cb=[]}__initConfig(){this._options&&(!this.data&&this._options.data&&(this.data=S(this._options.data)),!this.opts&&this._options.options&&(this.opts=S(this._options.options)));let{theme:t,padding:e,data:i,opts:n,events:o}=this._config.config||{};t&&(this.theme=t),e&&(this.padding=e),i&&(this.data=i),n&&(this.type==="echarts"?this.config=n:this.opts=n)}__initRender(){return new Promise(t=>{let e=async()=>{try{this.__setClassName(),this.__updateTheme(),this.transformOptions&&this.transform(),this.__transform(),this.instance||this._instance?(this.__callHook("onBeforeUpdate"),this.__update(),this.__callHook("onAfterUpdate"),this.updated&&this.updated()):(this.__callHook("onBeforeMounted"),await this.__render(),this.__callHook("onAfterMounted"),this.mounted&&this.mounted())}catch(i){g({id:this._compId,instance:this,error:i})}finally{t()}};this._isLoadingComp?e():this.cb.push(e)})}},T=E;gt(T,"used");T.__use([Ct,Dt,jt,kt,P,It,Vt,Ft]);var y=T;var it=class{constructor(t){this.instance=t||{},this.typeFnMapping={showOrHidden:this.__doShowOrHidden.bind(this),changeOptions:this.__doSetOptions.bind(this),callback:this.__doCallback.bind(this),secondFunction:this._doSecondFunction.bind(this),link:this.__doLink}}_registerType(t,e,i){if(typeof e!="function")return;let n=i||this;this.typeFnMapping[t]=e.bind(n)}__run(t,e){for(let i=0,n;n=e[i];i++)t._waitAction(n.identified).done(r=>{if(fe(n.condition,r)){this._beforeRun&&this._beforeRun({events:n,data:r});for(let c=0,h;h=n.actions[c];c++)this.__runAction(h,r);this._afterRun&&this._afterRun({events:n,data:r})}})}__runAction(t,e){let i=t.type;if(i!==void 0){if(!this.typeFnMapping[i]){g({error:`\u4E8B\u4EF6\u52A8\u4F5C${i}\u672A\u6CE8\u518C`});return}return this.typeFnMapping[i](t[i],e)}}_query(t){return typeof this.instance.query!="function"?null:Array.isArray(t)?t.map(e=>this.instance.query(e)):this.instance.query(t)}__doShowOrHidden(t){let{showComps:e,hiddenComps:i,type:n,showOptions:o,hiddenOptions:r}=t;return n==="group"&&(e=e.map(a=>a.split(",")).flat(),i=i.map(a=>a.split(",")).flat()),i.map(a=>{let c=this._query(a);c&&c.hidden(r)}),e.map(a=>{let c=this._query(a);c&&c.show(o)})}__doSetOptions(t){let{comp:e,opts:i}=t,n=this._query(e);n&&n.setOption(i)}__doLink(t){!t.url||_e(t.url)||window.open(t.url)}__doCallback(){}_doSecondFunction(t){let{name:e,arg:i}=t;this.instance[e]&&this.instance[e](i)}};function fe(s,t){if(s.enabled===!1)return!0;switch(s.type){case"code":return ue(s.filterCode,t);case"tree":return de(s,t);default:return!0}}function ue(s,t){return new Function("data",s)(t)}function de(s,t){return Ht(s,e=>Ht(e,i=>me(t,...i)))}function Ht(s,t){let e=ge(s.operator);return s.expressions.length?e.call(s.expressions,t):!0}function ge(s){switch(s){case"OR":return Array.prototype.some;case"AND":return Array.prototype.every;default:return()=>!1}}function me(s,t,e,i){let o=(s||{})[t];if(o==null||o==="")return!1;switch(e==="eq"||e==="in"||e==="nin"?(o=o.toString(),i=i.toString()):(o=o*1,i=i*1),e){case"eq":return o===i;case"gt":return o>i;case"lt":return o<i;case"gte":return o>=i;case"lte":return o<=i;case"ne":return o!=i;case"in":return o.toString().includes(i.toString());case"nin":return!o.toString().includes(i.toString())}}function _e(s){return!/(http|https):\/\/([\w.]+\/?)\S*/.test(s)}var M=it;var ye=/\/s-static(\/[\w-]+)+\.(bmp|gif|ico|tif|png|jpg|jpeg|webp|svg|mp4|webm|mp3|wav)/gi,Bt=({prefix:s,status:t})=>{switch(t){case"component":return{js:`${s}/component-source`,def:`${s}/complex-group-def`};default:return{js:`${s}/component`,def:`${s}/complex-group-version-def`}}};function nt(s,t){return s&&JSON.parse(JSON.stringify(s).replace(ye,e=>e.replace(/^(\/s-static)/,t)))}function be(s,t){let e=s.indexOf("C")>-1?s.slice(1):s,i=Bt(t).def;return new Promise(n=>{fetch(`${i}/${e}.def`).then(o=>o.json()).then(o=>{n(o)}).catch(o=>g({error:`Request Failed, ${o}`}))})}function we(s,{prefix:t}){let e=I(s,"scene.option.style")||{},i=[],n=[],o=[],r=[],a=[],c=[],h=[],l=[],d=[],f=s.scene.children[0],u=f.children||[],Qt=s.userData,N=[...u];if(f.option.visible!==!1)for(;N.length;){let w=N.shift();if(w.children)w.option.visible!==!1&&N.push(...w.children);else if(w.option.visible!==!1&&w.type==="Container"){let D=Qt[w.option.id],pt=D.name.substr(1);h.push(pt),l.push(w.option.id),n.push(nt(D.data,t)),o.push(nt(D.opts,t)),r.push(nt(D.theme,t)),c.push(D.padding),a.push(D.events);let ft={title:w.option.name,id:pt},v=w.option.style,ut={width:v.width,height:v.height,top:v.top,left:v.left,backgroundColor:v.backgroundColor||"",rotate:v.rotate};i.push(ut),v&&Object.assign(ft,ut),d.push(ft)}}return{width:e.width||"",height:e.height||"",childStyle:i,datas:n,opts:o,component:h,container:l,simpleCompInfo:d,themes:r,paddings:c,events:a}}var ot=class extends y{constructor(t,e){super(t,e),this.__initComp()}async __initComp(){this.customEvent=new M(this),this.useResizeScale=_t(this.useResizeScale)?this.useResizeScale:!0,this._componentInstances=[],this._options=[];let t=we(await be(this._compId,this._config),this._config);this.events=t.events||[],this.simpleCompInfo=t.simpleCompInfo,this.data=t.datas,this.opts=t.opts;let e=this.childStyle=t.childStyle,i=t.themes,n=t.paddings,o=t.container;(!this.size.width||!this.size.height)&&(this.size.width=t.width,this.size.height=t.height),this.parentDom.style.width=p(t.width),this.parentDom.style.height=p(t.height),this.dom.style.position="relative",this.resize();let r=Bt(this._config).js,a=this._config.status==="component"?"src":"";await Promise.all(t.component.map(c=>_.script([`C${c}`,`${r}/${c}${a}.js`]))),t.component.forEach((c,h)=>{let l=`C${c}`,d=document.createElement("div"),f=document.createElement("div");if(d.appendChild(f),this.dom.appendChild(d),e[h]){let u=e[h];Object.assign(f.style,{width:p(u.width),height:p(u.height)}),Object.assign(d.style,{position:"absolute",top:p(u.top),left:p(u.left),width:p(u.width),height:p(u.height),transform:`rotate(${u.rotate||0}deg)`,backgroundColor:u.backgroundColor})}this._config.config={theme:i[h],padding:n[h],data:this.data[h],opts:this.opts[h],events:this.events[h]};try{let u=new window.conch[l](f,{fromComplex:!0,_id:c,_ctId:o[h],...this._config});u._getParent=()=>this,this._componentInstances.push(u),this._options.push(u._options)}catch(u){g({error:u}),this.loadCompError({boundDom:d,graphDom:f,id:c,index:h})}}),this._config.config=null,await super.__initComp()}__render(){return Promise.all(this._componentInstances.map(async(t,e)=>{await t.render(),this.events[e]&&this.customEvent.__run(t,this.events[e])}))}__update(){this.eachInstance("__update")}__destroy(){this.eachInstance("destroy")}resize(){if(this.useResizeScale){let{width:t,height:e}=this.size,i=getComputedStyle(this.parentDom);this.parentDom.style.transform=`scale(${Math.min(parseInt(i.width)/t,parseInt(i.height)/e)})`,this.parentDom.style.width=p(t),this.parentDom.style.height=p(e)}}setData(t){this.eachInstance((e,i)=>{let n=t[i];n&&e.setData(n)})}setOption(t){this.eachInstance((e,i)=>{let n=t[i];n&&e.setOption(n)})}transform(){this.eachInstance("transform"),this.__transform()}__changeTitleDOM(t,e,i){super.__changeTitleDOM(t,e,i),this.__resizeParentHeight()}eachInstance(t){this._componentInstances.forEach((e,i)=>{typeof t=="string"?this[t].call(e):t(e,i)})}query(t){return t&&this._componentInstances.find(e=>e._config._id===t||e._config._ctId===t)}updateComponentStyle({width:t,height:e,backgroundColor:i,left:n,top:o,id:r,rotate:a}){let c=this.query(r);if(c){let h=c.dom.parentNode,l=h.parentNode;typeof t=="number"&&(h.style.width=l.style.width=p(t)),typeof e=="number"&&(h.style.height=l.style.height=p(e)),c.resize(),typeof a=="number"&&(l.style.transform=`rotate(${a}deg)`),typeof i=="string"&&(h.style.backgroundColor=i),typeof n=="number"&&(l.style.left=p(n)),typeof o=="number"&&(l.style.top=p(o))}}updateConfig(t,e){e===0&&(this._options=[]),this._options.push(t._options)}loadCompError(t){let{boundDom:e,graphDom:i,id:n,index:o}=t,r=this.childStyle[o];r&&(i.style.width=r.width,i.style.height=r.height,i.style.border="1px dashed red",e.style.position="absolute",e.style.top=r.top,e.style.left=r.left),i.innerHTML='<span style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); color: red">Error: \u56FE\u8868\u52A0\u8F7D\u5931\u8D25</span>'}},k=ot;var rt=class extends y{constructor(t,e){super(t,e),this.__initComp()}__render(){this.instance=window.echarts.init(this.dom),this.__update()}__update(){this.instance.clear(),this.instance.setOption(this.opts)}__destroy(){this.instance&&window.echarts.dispose(this.instance)}resize(){this.instance&&this.instance.resize()}setOption(t){if(this.config&&Object.prototype.toString.call(this.config).slice(8,-1)==="Object"){this.config=t,this.render();return}if(!this.instance)return;this.instance.setOption(t);let e={};Object.entries(this.instance._model._optionManager.mountOption()).forEach(([i,n])=>{if(n!=null){let o=JSON.stringify(n);if(o==="{}"||o==="[]")return;e[i]=n}}),this.opts=e}setData(t){if(this.config&&typeof this.config=="object"){this.data=C(t,this.data),this.render();return}if(t&&typeof t=="object"){let e=this.opts.series;if(Array.isArray(t)){if(t.length===0)return;let i;t[0].key&&t[0].value?(t=t.filter(n=>n.key&&n.value),i=n=>e.find(o=>o.name===n)):i=(n,o)=>e[o],t.forEach(({key:n,value:o},r)=>{let a=i(n,r);a&&(a.data=o)})}else Object.keys(t).forEach(i=>{let n=e.find(o=>o.name===i);n&&(n.data=t[i])});this.data=C(t,this.data),this.render()}}transform(){this.opts=this.transformOptions()}},L=rt;var Ce=s=>{if(!s)throw new Error("\u627E\u4E0D\u5230 vue \u73AF\u5883");return s},at=class extends y{static __richComp(t){let e=t.prototype;e.__getDom=e.render,super.__richComp(t)}constructor(t,e){window.conch.registerVue(e.Vue),super(t,e),this.__initComp()}__render(){let t=Ce(window.conch.Vue||window.Vue),e=20,i=performance.now(),n=this;this.instance=new t({el:this.dom,render:o=>{if(e<=0){let r="[conch error] \u56FE\u8868\u88AB\u91CD\u590D\u6E32\u67D3\uFF0C\u8BF7\u6CE8\u610F";throw g({error}),new Error(r)}return performance.now()-i<20?e-=1:e=20,this.$createElement=o,this.__getDom(o,this.data,this.opts)},parent:V(t)}),this.dom=this.instance.$el}__update(){this.instance.$forceUpdate()}__destroy(){this.instance.$destroy()}resize(){this.useResizeScale&&(this.parentDom.style.width="100%",this.parentDom.style.height="100%")}setData(t,e){this.data=C(t,this.data),this.instance&&this.render()}setOption(t,e){this.opts=C(t,this.opts),this.instance&&this.render()}transform(){this.transformOptions()}__changeTitleDOM(t,e,i){super.__changeTitleDOM(t,e,i),this.__resizeParentHeight()}},R=at;var Oe={default:R,echarts:L,complex:k},ct=class extends y{static __richComp(t){let e=t.prototype;e.__getDom=e.render,e.render=e.__initRender;let i=e.destroy;e.destroy=function(){(m(i)?function(){this.__destroy(),i.call(this)}:this.__destroy).call(this)}}constructor(t,e={}){super(t,e),this.type=this.type||"default",window.conch.registerVue(this._config.Vue);let i=["setData","setOption"],n={};i=i.filter(o=>{let r=typeof this[o]!="function";return r&&(this[o]=function(a){n[o]=a}),r}),setTimeout(()=>{i.forEach(o=>{this[o]=null}),q(this,Oe[this.type].prototype,!1),this.type==="complex"?k.prototype.__initComp.call(this):this.__initComp(),Object.entries(n).forEach(([o,r])=>{this[o].call(this,r)})})}},qt=ct;function b(s,t){if(!(this instanceof b))return new b(s,t);this.proto=s,this.target=t,this.methods=[],this.getters=[],this.setters=[],this.fluents=[]}b.auto=function(s,t,e){for(var i=b(s,e),n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var r=n[o],a=Object.getOwnPropertyDescriptor(t,r);if(a.get&&i.getter(r),a.set&&i.setter(r),a.hasOwnProperty("value")){var c=a.value;c instanceof Function?i.method(r):i.getter(r),a.writable&&i.setter(r)}}};b.prototype.method=function(s){var t=this.proto,e=this.target;return this.methods.push(s),t[s]=function(){return this[e][s].apply(this[e],arguments)},this};b.prototype.access=function(s){return this.getter(s).setter(s)};b.prototype.getter=function(s){var t=this.proto,e=this.target;return this.getters.push(s),t.__defineGetter__(s,function(){return this[e][s]}),this};b.prototype.setter=function(s){var t=this.proto,e=this.target;return this.setters.push(s),t.__defineSetter__(s,function(i){return this[e][s]=i}),this};b.prototype.fluent=function(s){var t=this.proto,e=this.target;return this.fluents.push(s),t[s]=function(i){return typeof i<"u"?(this[e][s]=i,this):this[e][s]},this};var Ut=b;var ve=s=>{if(!s)throw new Error("\u627E\u4E0D\u5230 vue \u73AF\u5883");return s},De=["data","opts","config","parentDom","themes","themeIndex","type","useResizeScale","titleDom","subTitleDom","padding","theme","size","_config","_options","_isLoadingComp","_key","img","fonts","css","script","log"],Se=["setData","setOption","resize","render","$on","$once","$off","$emit","show","hide","transformOptions","getBlueprintNode","onExecute","onStop","query","updateComponentStyle","setTitle","openTitle","closeTitle","setSubTitle","openSubTitle","closeSubTitle","setCompBG","setPadding","setTheme","trigger"],Gt=new Set(["resize"]),Ee=new Set(["dom","instance"]),Kt=new Set(["setData","setOption","setTheme"]),ht=class extends y{static __richComp(t){super.__richComp(t)}constructor(t,e){window.conch.registerVue(e.Vue),super(t,e),this.__initComp(),this.useResizeScale=!1,this.vmUseProtoMethods=new Set}__render(){let t=ve(window.conch.Vue||window.Vue),e=this.__mergeVueInstData(),i=function(){return{...e}},{data:n,mounted:o,...r}=this.vueInstConfig,a=this.__instanceKey,c=this.type==="echarts",h=this.__initChart.bind(this);this[a]=new t({el:this.dom,data:i,mounted:this.__vueInstMounted(o,c&&h),...r,parent:V(t)});let l=this.render.bind(this);this.type==="echarts"?this[a].$watch("config",l):this[a].$watch("opts",l),this[a].$watch("theme",l),this[a].$watch("data",l),this[a].$watch("padding",l),this.dom=this[a].$el,this.__getMethodsFromProp(),this.render();let d=new Ut(this,a);for(let f in this[a])Ee.has(f)||!Kt.has(f)&&!Gt.has(f)&&(m(this[a][f])?d.method(f):d.access(f))}__update(){let t=this.__instanceKey;this[t]?.$forceUpdate(),this.type==="echarts"&&this.__updateChart(this.opts),this.__transform()}__destroy(){let t=this.__instanceKey;this[t]?.$destroy()}resize(){let t=this.type==="echarts",e=!this.vmUseProtoMethods.has("resize");t?e?this._instance?.resize&&this._instance.resize():this.instance&&this.instance.resize():e?this.instance?.resize&&this.instance.resize():this.useResizeScale&&(this.parentDom.style.width="100%",this.parentDom.style.height="100%")}setData(t){let e=this.__instanceKey;if(!this[e]){this.data=C(t,this.data);return}this.data=C(t,this[e].data),this[e].data=this.data,this[e]&&this.render()}setOption(t){let e=this.__instanceKey,i=this.type==="echarts";if(!this[e]){if(i){this.config=opts;return}this.opts=t;return}i?this.config&&Object.prototype.toString.call(this.config).slice(8,-1)==="Object"&&(this.config={...this[e].config,...t},this[e].config=this.config):(this.opts={...this[e].opts,...t},this[e].opts=this.opts),this[e]&&this.render()}setTheme(t){let e=this.__instanceKey;if(!this[e]){this.theme=t;return}this.theme={...this[e].theme,...t},this[e].theme=this.theme,this.render()}transform(){this.type==="echarts"&&(this.opts=this.transformOptions())}__changeTitleDOM(t,e,i){super.__changeTitleDOM(t,e,i),this.__resizeParentHeight()}__mergeVueInstData(){let t=De,e={};for(let a in this){let c=m(this[a]);t.includes(a)&&!c&&(e[a]=this[a])}let{data:i}=this.vueInstConfig,n=m(i)?i():i,o={...n,...e,type:n?.type||"vueSFC"};Object.assign(this,o);let r=o.type==="echarts";return this.__instanceKey=`${r?"_":""}instance`,o}__initChart(t,e){if(t.nodeType!==1)throw new Error("echart \u521D\u59CB\u5316\u7F3A\u5C11 element \u8282\u70B9");return this.opts=e,this.instance=window.echarts.init(t),this.__updateChart(e),this.instance}__updateChart(t){this.instance&&(this.instance.clear(),this.instance.setOption(t))}__vueInstMounted(t,e){let i=this.parent;return function(){if(e){let n;if(this.transformOptions)n=this.transformOptions();else throw new Error("echarts\u7C7B\u7EC4\u4EF6\u9700\u5B9E\u73B0transformOptions\u65B9\u6CD5");this.instance||(this.instance=e(this.$refs.echarts||this.$el,n))}else this.instance=this;this.dom=this.$el,this.parent=i,t&&t.call(this)}}__getMethodsFromProp(){let t=this.__instanceKey;for(let e of Se)if(!!m(this[e]))if($(this[t][e]))this[t][e]=this[e].bind(this),this.vmUseProtoMethods.add(e);else{if(Kt.has(e)){let n=this[t][e],o=function(...r){n.apply(this,r)};this[t][e]=o.bind(this[t])}Gt.has(e)||(this[e]=this[t][e].bind(this[t]))}}},Wt=ht;var lt={Default:R,Complex:k,Echarts:L,OldBase:qt,VueSFC:Wt};var x=z(j());console.log("compile version is "+x.version);var Jt={version:x.version,Vue:null,__globalVar:x.globalVar,Base:lt.OldBase,CustomEvent:M,...lt,createCss:_.style,$on:O.$on.bind(O),$emit:O.$emit.bind(O),$off:O.$off.bind(O),install(s){this.Vue=s},register(s,t,e,i,n="default",o="1"){bt(o,x.version)===1&&g({id:s,error:`\u5F53\u524D\u7EC4\u4EF6${s}\u7248\u672C\u9AD8\u4E8E\u8FD0\u884C\u7248\u672C\uFF0C\u9700\u8981\u5347\u7EA7\u7EC4\u4EF6\u8FD0\u884C\u73AF\u5883`}),i&&this.registerVue(i),e.script&&(this.__globalVar.scripts=Object.assign(this.__globalVar.scripts,e.script)),t.prototype.version=o,t.prototype.__richConfig=e,t.prototype._compId=s,t.__richComp(t,s,e),this[s]=t},registerVue(s){s&&(!this.Vue&&(this.Vue=s),!window.Vue&&(window.Vue=s))},async loadAllScript(){this.__globalVar.async=!0;let s=Object.entries(this.__globalVar.scripts).filter(([t,e])=>typeof e=="string");await Promise.all(s.map(t=>_.script(t,prefix)))}},Xt=new Set(Object.keys(Jt));Xt.delete("__globalVar");var xe=new Proxy(Jt,{set(s,t,e){return s[t]&&s[t]!==e&&Xt.has(t)?(g({error:`conch.${t}\u4E0D\u652F\u6301\u4FEE\u6539`}),Reflect.set(s,t,s[t])):Reflect.set(...arguments)}});Object.defineProperty(window,"conch",{configurable:!0,value:xe,writable:!1});})();
